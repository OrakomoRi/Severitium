class SeveritiumInjector{constructor(e,t){this.Severitium=e,this.season=t}updateSeveritium(e){this.Severitium=e}generateLibraryTransferCode(){const e=["BreeziumSelect","Swal","jQuery","$","_","moment","axios","fetch"];let t="// Auto-transfer userscript libraries\n";for(const r of e)t+=`if (typeof ${r} !== 'undefined' && typeof window.${r} === 'undefined') window.${r} = ${r};\n`;return t+="\n\t\t// Auto-detect additional libraries\n\t\ttry {\n\t\t\tconst userscriptGlobals = Object.getOwnPropertyNames(this);\n\t\t\tfor (const name of userscriptGlobals) {\n\t\t\t\tif (typeof this[name] === 'function' && name[0] === name[0].toUpperCase() && typeof window[name] === 'undefined') {\n\t\t\t\t\twindow[name] = this[name];\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e) {}\n\t\t",t}removeInjectedCSS(){const e=document.querySelectorAll('style[data-resource="SeveritiumCSS"]');for(const t of e)t.remove()}injectCSS(e,t=[]){const r=document.createElement("style");r.textContent=this.Severitium.CSS[e];for(const e of t)r.setAttribute(e.name,e.value);document.body.appendChild(r)}applyCSS(e=null){if(!e)return;this.removeInjectedCSS();const t={name:"data-resource",value:"SeveritiumCSS"},r=Array.isArray(e)?e:[{url:e}];for(const{url:e,attributes:n=[]}of r){const r=n.some(e=>"data-resource"===e.name)?n:[t,...n];this.injectCSS(e,r)}}removeInjectedJS(){const e=document.querySelectorAll('script[data-resource="SeveritiumJS"]');for(const t of e)t.remove()}injectJS(e,t=[]){const r=document.createElement("script"),n=this.generateLibraryTransferCode();r.textContent=`\n\t\t\t${n}\n\t\t\t${this.Severitium.JS[e]}\n\t\t`;for(const e of t)r.setAttribute(e.name,e.value);document.body.appendChild(r)}applyJS(e=null){if(!e)return;this.removeInjectedJS();const t={name:"data-resource",value:"SeveritiumJS"},r=Array.isArray(e)?e:[{url:e}];for(const{url:e,attributes:n=[]}of r){const r=n.some(e=>"data-resource"===e.name)?n:[t,...n];this.injectJS(e,r)}}removeInjectedImages(){const e=document.querySelectorAll('style[data-resource="SeveritiumImage"]');for(const t of e)t.remove()}injectImage(e,t,r=[]){const n=t.replace("SEVERITIUM_PLACEHOLDER",this.Severitium.images[e]),o=document.createElement("style");o.textContent=n;for(const e of r)o.setAttribute(e.name,e.value);document.body.appendChild(o)}applyImages(e=null){if(!e)return;this.removeInjectedImages();const t={name:"data-resource",value:"SeveritiumImage"};for(const{url:r,style:n,attributes:o=[]}of e){const e=r.replace("SEASON_PLACEHOLDER",this.season),s=o.some(e=>"data-resource"===e.name)?o:[t,...o];this.injectImage(e,n,s)}}}